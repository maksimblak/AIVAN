#!/usr/bin/env python3
"""
Тестирование функции render_legal_html
"""

# Импортируем функцию из основного файла
import os
import sys

sys.path.append(os.path.join(os.path.dirname(__file__), "src", "core"))

from main_simple import render_legal_html

# Тестовый текст с тем, что вы получили в Telegram
test_text = """Коротко: да — расторгнуть договор поставки за просрочку можно, но только при выполнении определённых условий и с соблюдением процессуальной порядочности. Подробно — ниже: когда это возможно, на каких нормах опираться, какие шаги предпринять и шаблон уведомления об одностороннем отказе.

1) Правовая основа — что говорит закон

— Односторонний отказ от исполнения договора поставки допускается в случае существенного нарушения договора одной из сторон (ст. 523 ГК РФ). Существенным нарушение для поставщика в том числе признаётся неоднократное нарушение сроков поставки. (base.garant.ru)

— Право на односторонний отказ (и порядок его реализации через уведомление) закреплено в ст. 450.1 ГК РФ — договор считается расторгнутым с момента получения уведомления, если иное не установлено законом или договором; при реализации права нужно действовать добросовестно и разумно. (base.garant.ru)

2) Практический вывод: когда расторжение — реально, а когда — маловероятно

— Реально (высокая вероятность успеха): неоднократные просрочки поставщика; системные срывы графика поставок по партиям; просрочки по товарам, для которых срок критичен (скоропортящиеся, сезонные поставки) если это прямо следует из договора или характера сделки. (base.garant.ru)
"""


# Тестируем функцию
def test_render():
    print("=== ТЕСТИРОВАНИЕ ФУНКЦИИ render_legal_html ===")
    print("\nИсходный текст:")
    print(test_text)
    print("\n" + "=" * 60)

    result = render_legal_html(test_text)

    print("\nРезультат форматирования:")
    print(result)
    print("\n" + "=" * 60)

    # Проверяем наличие важных элементов
    print("\nПроверка элементов:")
    print(f"Содержит <b>1) </b>: {'ДА' if '<b>1) </b>' in result else 'НЕТ'}")
    print(f"Содержит <b>2) </b>: {'ДА' if '<b>2) </b>' in result else 'НЕТ'}")
    print(f"Содержит <b>ст. 523</b>: {'ДА' if '<b>ст. 523</b>' in result else 'НЕТ'}")
    print(f"Содержит <b>ст. 450.1</b>: {'ДА' if '<b>ст. 450.1</b>' in result else 'НЕТ'}")
    print(f"Содержит <br>: {'ДА' if '<br>' in result else 'НЕТ'}")
    print(f"Количество <br> тегов: {result.count('<br>')}")

    # Проверяем на двойное экранирование
    print(f"Содержит &lt;b&gt; (двойное экранирование): {'ДА' if '&lt;b&gt;' in result else 'НЕТ'}")


if __name__ == "__main__":
    test_render()
