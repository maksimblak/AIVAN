"""
UI ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ Telegram Ð±Ð¾Ñ‚Ð° Ð˜Ð˜-Ð˜Ð²Ð°Ð½
Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹, ÑÐ¼Ð¾Ð´Ð·Ð¸, ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
"""

from __future__ import annotations
from typing import Optional
# Callback ÐºÐ»Ð°ÑÑÑ‹ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹ Ð±ÐµÐ· inline ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€

# ============ Ð­ÐœÐžÐ”Ð—Ð˜ ÐšÐžÐÐ¡Ð¢ÐÐÐ¢Ð« ============

class Emoji:
    """ÐšÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ñ ÑÐ¼Ð¾Ð´Ð·Ð¸ Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°"""
    
    # ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ
    ROBOT = "ðŸ¤–"
    LAW = "âš–ï¸"
    DOCUMENT = "ðŸ“‹"
    SEARCH = "ðŸ”"
    IDEA = "ðŸ’¡"
    WARNING = "âš ï¸"
    SUCCESS = "âœ…"
    ERROR = "âŒ"
    LOADING = "â³"
    FIRE = "ðŸ”¥"
    STAR = "â­"
    MAGIC = "âœ¨"
    
    # ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¿Ñ€Ð°Ð²Ð°
    CIVIL = "ðŸ "
    CRIMINAL = "ðŸš¨" 
    CORPORATE = "ðŸ¢"
    CONTRACT = "ðŸ“"
    LABOR = "ðŸ‘¨â€ðŸ’¼"
    TAX = "ðŸ’°"
    REAL_ESTATE = "ðŸ˜ï¸"
    IP = "ðŸ’¼"
    ADMIN = "ðŸ›ï¸"
    FAMILY = "ðŸ‘ª"
    
    # ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ
    BACK = "â—€ï¸"
    HOME = "ðŸ "
    HELP = "â“"
    SETTINGS = "âš™ï¸"
    STATS = "ðŸ“Š"
    UP = "ðŸ”º"
    DOWN = "ðŸ”»"
    
    # Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
    SAVE = "ðŸ’¾"
    SHARE = "ðŸ“¤"
    COPY = "ðŸ“„"
    PRINT = "ðŸ–¨ï¸"
    DOWNLOAD = "ðŸ“¥"
    
    # Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹
    ONLINE = "ðŸŸ¢"
    OFFLINE = "ðŸ”´"
    PENDING = "ðŸŸ¡"
    CLOCK = "ðŸ•"
    CALENDAR = "ðŸ“…"

# ============ Ð¦Ð’Ð•Ð¢ÐžÐ’Ð«Ð• Ð¡Ð¥Ð•ÐœÐ« ============

class Colors:
    """Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ (Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ð² Telegram, Ð½Ð¾ Ð´Ð»Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸)"""
    PRIMARY = "#2196F3"    # Ð¡Ð¸Ð½Ð¸Ð¹
    SUCCESS = "#4CAF50"    # Ð—ÐµÐ»ÐµÐ½Ñ‹Ð¹
    WARNING = "#FF9800"    # ÐžÑ€Ð°Ð½Ð¶ÐµÐ²Ñ‹Ð¹
    ERROR = "#F44336"      # ÐšÑ€Ð°ÑÐ½Ñ‹Ð¹
    INFO = "#00BCD4"       # Ð“Ð¾Ð»ÑƒÐ±Ð¾Ð¹

# ============ Ð¨ÐÐ‘Ð›ÐžÐÐ« Ð¡ÐžÐžÐ‘Ð©Ð•ÐÐ˜Ð™ ============

class MessageTemplates:
    """Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ñ ÐºÑ€Ð°ÑÐ¸Ð²Ñ‹Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼"""
    
    WELCOME = f"""{Emoji.LAW} **Ð˜Ð˜\\-Ð˜Ð²Ð°Ð½** â€” Ð²Ð°Ñˆ ÑŽÑ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚

{Emoji.ROBOT} Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑÑŒ Ð½Ð° Ñ€Ð¾ÑÑÐ¸Ð¹ÑÐºÐ¾Ð¼ Ð¿Ñ€Ð°Ð²Ðµ Ð¸ ÑÑƒÐ´ÐµÐ±Ð½Ð¾Ð¹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐµ
{Emoji.SEARCH} ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ð´ÐµÐ»Ð°, Ð½Ð°Ñ…Ð¾Ð¶Ñƒ Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½ÑƒÑŽ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒ  
{Emoji.DOCUMENT} Ð“Ð¾Ñ‚Ð¾Ð²Ð»ÑŽ Ñ‡ÐµÑ€Ð½Ð¾Ð²Ð¸ÐºÐ¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²

{Emoji.WARNING} *Ð’Ð°Ð¶Ð½Ð¾*: Ð²ÑÐµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÑŽÑ€Ð¸ÑÑ‚Ð¾Ð¼

Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:"""

    HELP = f"""{Emoji.HELP} **Ð¡Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ**

{Emoji.MAGIC} **Ð”Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð»ÑƒÑ‡ÑˆÐ¸Ñ… Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²:**

{Emoji.IDEA} Ð£ÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½ÑƒÑŽ ÑŽÑ€Ð¸ÑÐ´Ð¸ÐºÑ†Ð¸ÑŽ
{Emoji.CALENDAR} Ð£Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹Ñ‚Ðµ Ð´Ð°Ñ‚Ñ‹ Ð²Ð°Ð¶Ð½Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
{Emoji.DOCUMENT} ÐžÐ¿Ð¸ÑÑ‹Ð²Ð°Ð¹Ñ‚Ðµ Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð±ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð°
{Emoji.STAR} Ð¤Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ‡ÐµÑ‚ÐºÐ¸Ð¹ Ð¿Ñ€Ð°Ð²Ð¾Ð²Ð¾Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ

{Emoji.LAW} **Ð§Ñ‚Ð¾ Ñ ÑƒÐ¼ÐµÑŽ:**
â€¢ ÐÐ½Ð°Ð»Ð¸Ð· ÑÑƒÐ´ÐµÐ±Ð½Ð¾Ð¹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸
â€¢ ÐŸÐ¾Ð¸ÑÐº Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ñ‹Ñ… Ð´ÐµÐ»
â€¢ ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²
â€¢ ÐžÑ†ÐµÐ½ÐºÐ° Ð¿Ñ€Ð°Ð²Ð¾Ð²Ñ‹Ñ… Ñ€Ð¸ÑÐºÐ¾Ð²
â€¢ Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð°Ð²Ð¾Ð²Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ð¸

{Emoji.WARNING} **ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ:**
ÐÐµ Ñ€Ð°Ð·Ð³Ð»Ð°ÑˆÐ°Ð¹Ñ‚Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÑ‚ÑŒÐ¸Ñ… Ð»Ð¸Ñ†"""

    CATEGORIES = f"""{Emoji.LAW} **Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð°**

Ð’Ñ‹Ð±Ð¾Ñ€ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¸ Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚:"""

    PROCESSING_STAGES = [
        f"{Emoji.SEARCH} ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ð²Ð°Ñˆ Ð²Ð¾Ð¿Ñ€Ð¾Ñ...",
        f"{Emoji.LOADING} Ð˜Ñ‰Ñƒ Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½ÑƒÑŽ ÑÑƒÐ´ÐµÐ±Ð½ÑƒÑŽ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒ...",
        f"{Emoji.DOCUMENT} Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚...",
        f"{Emoji.MAGIC} Ð¤Ð¸Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸..."
    ]
    
    ERROR_GENERIC = f"""{Emoji.ERROR} **ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°**

Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð²Ð°Ñˆ Ð·Ð°Ð¿Ñ€Ð¾Ñ\\.

{Emoji.HELP} *Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸:*
â€¢ ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€Ð¾Ð²ÐºÑƒ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°
â€¢ ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¼Ð¸Ð½ÑƒÑ‚
â€¢ ÐžÐ±Ñ€Ð°Ñ‚Ð¸Ñ‚ÐµÑÑŒ Ðº Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñƒ ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ"""

    NO_QUESTION = f"""{Emoji.WARNING} **ÐŸÑƒÑÑ‚Ð¾Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ**

ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ñ‚ÐµÐºÑÑ‚ ÑŽÑ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°\\."""

# ============ ÐšÐ›ÐÐ’Ð˜ÐÐ¢Ð£Ð Ð« Ð£Ð‘Ð ÐÐÐ« ============
# Ð’ÑÐµ inline ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ

# ============ ÐšÐÐ¢Ð•Ð“ÐžÐ Ð˜Ð˜ ÐŸÐ ÐÐ’Ð ============

LEGAL_CATEGORIES = {
    "civil": {
        "name": "Ð“Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÐºÐ¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾",
        "emoji": Emoji.CIVIL,
        "description": "Ð˜Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸ Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð½ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ",
        "examples": ["Ð”Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹", "Ð¡Ð¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ", "ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð°", "Ð”ÐµÐ»Ð¸ÐºÑ‚Ñ‹"]
    },
    "corporate": {
        "name": "ÐšÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾", 
        "emoji": Emoji.CORPORATE,
        "description": "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¸ Ð´ÐµÑÑ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÑŽÑ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð»Ð¸Ñ†",
        "examples": ["Ð£Ñ‡Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ ÐžÐžÐž", "ÐšÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ ÑÐ¿Ð¾Ñ€Ñ‹", "Ð ÐµÐ¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ", "M&A"]
    },
    "contract": {
        "name": "Ð”Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾",
        "emoji": Emoji.CONTRACT, 
        "description": "Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ, Ð¸ÑÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¸ Ñ€Ð°ÑÑ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð²",
        "examples": ["ÐŸÐ¾ÑÑ‚Ð°Ð²ÐºÐ°", "ÐŸÐ¾Ð´Ñ€ÑÐ´", "ÐÑ€ÐµÐ½Ð´Ð°", "Ð—Ð°Ð¹Ð¼"]
    },
    "labor": {
        "name": "Ð¢Ñ€ÑƒÐ´Ð¾Ð²Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾",
        "emoji": Emoji.LABOR,
        "description": "Ð¢Ñ€ÑƒÐ´Ð¾Ð²Ñ‹Ðµ Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ Ð¸ ÑÐ¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°",
        "examples": ["Ð£Ð²Ð¾Ð»ÑŒÐ½ÐµÐ½Ð¸Ðµ", "Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð°", "ÐžÑ‚Ð¿ÑƒÑÐºÐ°", "Ð”Ð¸ÑÑ†Ð¸Ð¿Ð»Ð¸Ð½Ð°"]
    },
    "tax": {
        "name": "ÐÐ°Ð»Ð¾Ð³Ð¾Ð²Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾", 
        "emoji": Emoji.TAX,
        "description": "ÐÐ°Ð»Ð¾Ð³Ð¾Ð¾Ð±Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¸ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð¤ÐÐ¡",
        "examples": ["ÐÐ”Ð¡", "ÐÐ°Ð»Ð¾Ð³ Ð½Ð° Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ", "ÐÐ”Ð¤Ð›", "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ¸"]
    },
    "real_estate": {
        "name": "ÐŸÑ€Ð°Ð²Ð¾ Ð½ÐµÐ´Ð²Ð¸Ð¶Ð¸Ð¼Ð¾ÑÑ‚Ð¸",
        "emoji": Emoji.REAL_ESTATE,
        "description": "Ð¡Ð´ÐµÐ»ÐºÐ¸ Ñ Ð½ÐµÐ´Ð²Ð¸Ð¶Ð¸Ð¼Ð¾ÑÑ‚ÑŒÑŽ Ð¸ Ð·ÐµÐ¼ÐµÐ»ÑŒÐ½Ñ‹Ð¼Ð¸ ÑƒÑ‡Ð°ÑÑ‚ÐºÐ°Ð¼Ð¸", 
        "examples": ["ÐšÑƒÐ¿Ð»Ñ-Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°", "ÐÑ€ÐµÐ½Ð´Ð°", "Ð˜Ð¿Ð¾Ñ‚ÐµÐºÐ°", "ÐšÐ°Ð´Ð°ÑÑ‚Ñ€"]
    },
    "ip": {
        "name": "Ð˜Ð½Ñ‚ÐµÐ»Ð»ÐµÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð°Ñ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ",
        "emoji": Emoji.IP,
        "description": "ÐÐ²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ðµ Ð¿Ñ€Ð°Ð²Ð°, Ñ‚Ð¾Ð²Ð°Ñ€Ð½Ñ‹Ðµ Ð·Ð½Ð°ÐºÐ¸, Ð¿Ð°Ñ‚ÐµÐ½Ñ‚Ñ‹",
        "examples": ["Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¢Ð—", "ÐÐ²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ðµ Ð¿Ñ€Ð°Ð²Ð°", "ÐŸÐ°Ñ‚ÐµÐ½Ñ‚Ñ‹", "Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ð¸"]
    },
    "admin": {
        "name": "ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾",
        "emoji": Emoji.ADMIN,
        "description": "Ð’Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð³Ð¾ÑÐ¾Ñ€Ð³Ð°Ð½Ð°Ð¼Ð¸ Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ",
        "examples": ["Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ", "Ð¨Ñ‚Ñ€Ð°Ñ„Ñ‹", "Ð“Ð¾ÑÑƒÑÐ»ÑƒÐ³Ð¸", "ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ"]  
    },
    "criminal": {
        "name": "Ð£Ð³Ð¾Ð»Ð¾Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾",
        "emoji": Emoji.CRIMINAL,
        "description": "ÐŸÑ€ÐµÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ñ Ð¸ ÑƒÐ³Ð¾Ð»Ð¾Ð²Ð½Ð°Ñ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ",
        "examples": ["Ð­ÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€ÐµÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ñ", "Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚Ð½Ñ‹Ðµ", "ÐÐ°Ð»Ð¾Ð³Ð¾Ð²Ñ‹Ðµ", "Ð—Ð°Ñ‰Ð¸Ñ‚Ð°"]
    },
    "family": {
        "name": "Ð¡ÐµÐ¼ÐµÐ¹Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¾", 
        "emoji": Emoji.FAMILY,
        "description": "Ð‘Ñ€Ð°Ðº, Ñ€Ð°Ð·Ð²Ð¾Ð´, Ð°Ð»Ð¸Ð¼ÐµÐ½Ñ‚Ñ‹, Ð¾Ð¿ÐµÐºÐ°",
        "examples": ["Ð Ð°Ð·Ð²Ð¾Ð´", "ÐÐ»Ð¸Ð¼ÐµÐ½Ñ‚Ñ‹", "Ð Ð°Ð·Ð´ÐµÐ» Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°", "ÐžÐ¿ÐµÐºÐ°"]
    }
}

def get_category_info(category_id: str) -> dict:
    """ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¿Ñ€Ð°Ð²Ð°"""
    return LEGAL_CATEGORIES.get(category_id, {
        "name": "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",
        "emoji": Emoji.LAW,
        "description": "ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð°Ð²Ð¾Ð²Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹",
        "examples": []
    })

# ============ Ð¤ÐžÐ ÐœÐÐ¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð• ============

def escape_markdown_v2(text: str) -> str:
    """Ð­ÐºÑ€Ð°Ð½Ð¸Ñ€ÑƒÐµÑ‚ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹ Ð´Ð»Ñ MarkdownV2"""
    special_chars = ['_', '*', '[', ']', '(', ')', '~', '`', '>', '#', '+', '-', '=', '|', '{', '}', '.', '!']
    for char in special_chars:
        text = text.replace(char, f'\\{char}')
    return text

def format_legal_response(text: str, category: Optional[str] = None) -> str:
    """Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚ Ñ ÐºÑ€Ð°ÑÐ¸Ð²Ð¾Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ‚ÐºÐ¾Ð¹ MarkdownV2"""
    
    # Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÐµÐ¹
    if category:
        category_info = get_category_info(category)
        header = f"{category_info['emoji']} **{escape_markdown_v2(category_info['name'])}**\n\n"
        text = header + text
    

    return text

def create_progress_message(stage: int, total: int = 4) -> str:
    """Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¾Ð¼"""
    if stage >= len(MessageTemplates.PROCESSING_STAGES):
        stage = len(MessageTemplates.PROCESSING_STAGES) - 1
        
    progress_bar = "â–“" * stage + "â–‘" * (total - stage)
    percentage = int((stage / total) * 100)
    
    return f"{MessageTemplates.PROCESSING_STAGES[stage]}\n\n`{progress_bar}` {percentage}%"
